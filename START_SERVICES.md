# Инструкции по запуску сервисов для тестирования

## Текущий статус

- ✅ База данных PostgreSQL работает на порту 5432
- ⚠️ API сервер не запущен (требуется запуск)
- ⚠️ Telegram бот не запущен (требуется запуск)
- ⚠️ Миграции не применены (требуется применение)

## Шаги для запуска

### 1. Применить миграции (если еще не применены)

```bash
cd twelvesteps
# Установите alembic если не установлен: pip install alembic
# Затем примените миграции через Python:
python -c "from alembic.config import Config; from alembic import command; cfg = Config('alembic.ini'); command.upgrade(cfg, 'head')"
```

### 2. Запустить API сервер

Откройте новый терминал:
```bash
cd twelvesteps
python -m uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

Проверьте, что сервер запустился:
- Откройте http://localhost:8000/docs в браузере
- Должна открыться документация Swagger UI

### 3. Запустить Telegram бота

Откройте еще один терминал:
```bash
cd twelvesteps_tgbot
python main.py
```

Проверьте, что бот запустился:
- В логах должно быть сообщение о начале polling
- Откройте Telegram и найдите вашего бота
- Отправьте команду `/start`

## Тестирование

После запуска всех сервисов следуйте инструкциям в `TESTING_CHECKLIST.md`:

1. **Тестирование API эндпоинтов:**
   - Используйте Swagger UI: http://localhost:8000/docs
   - Или используйте скрипт: `python test_api_endpoints.py`

2. **Тестирование Telegram бота:**
   - Отправьте команду `/start`
   - Проверьте регистрацию
   - Проверьте валидацию ввода
   - Проверьте команды `/thanks` и `/day`

3. **Проверка базы данных:**
   - Убедитесь, что все таблицы созданы
   - Проверьте, что данные сохраняются корректно

## Устранение проблем

### API не запускается
- Проверьте, что все зависимости установлены: `pip install -r requirements.txt`
- Проверьте, что база данных доступна
- Проверьте логи на наличие ошибок

### Бот не запускается
- Проверьте, что `BOT_TOKEN` указан в `telegram.env`
- Проверьте, что API сервер запущен и доступен
- Проверьте логи на наличие ошибок

### Ошибки подключения к базе данных
- Убедитесь, что PostgreSQL запущен
- Проверьте `DATABASE_URL` в `backend.env`
- Проверьте, что миграции применены

